---
import Layout from "../../layouts/Layout.astro";
import products from "../../data/products.json";

export async function getStaticPaths() {
  return products.map((p) => ({
    params: { slug: p.slug },
    props: { product: p },
  }));
}

const { product } = Astro.props as { product: {
  slug: string;
  title: string;
  summary?: string;
  productImage: string;
  whyCreate: string;
  thoughts: string;
  technologies?: string[];
  githubLink?: string;
  url?: string;
} };
---

<Layout>
  <main class="mx-auto max-w-5xl px-4 py-12">
    <h1 class="text-3xl md:text-4xl font-bold tracking-tight">{product.title}</h1>
    {product.summary && <p class="mt-2 text-white/70">{product.summary}</p>}

    {product.technologies && product.technologies.length > 0 && (
      <section class="mt-6">
        <h2 class="text-sm uppercase tracking-wider text-white/50">Technologies</h2>
        <div class="mt-2 flex flex-wrap gap-2">
          {product.technologies.map((t) => (
            <span class="px-3 py-1 rounded-full border border-white/10 bg-white/5 text-sm">{t}</span>
          ))}
        </div>
      </section>
    )}

    <img src={product.productImage} alt={product.title} class="pt-8 w-full rounded-lg border border-white/10 shadow-lg" />

    <section class="mt-10">
      <h2 class="text-2xl font-semibold">なぜ作ったか</h2>
      <p class="mt-4 text-white/80 leading-relaxed">{product.whyCreate}</p>
    </section>

    <section class="mt-10">
      <h2 class="text-2xl font-semibold">作って考えたこと</h2>
      <p class="mt-4 text-white/80 leading-relaxed">{product.thoughts}</p>
    </section>

    <div class="flex gap-5">
      {product.githubLink && (
        <p class="mt-6">
          <a class="inline-flex md:text-base items-center gap-2 px-4 py-2 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 transition" href={product.githubLink} target="_blank" rel="noopener noreferrer">View GitHub →</a>
        </p>
      )}
      {product.url && (
        <p class="mt-6">
          <a class="inline-flex md:text-base items-center gap-2 px-4 py-2 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 transition" href={product.url} target="_blank" rel="noopener noreferrer">Visit project →</a>
        </p>
      )}
    </div>

    <p class="mt-10">
      <a href="/products" class="text-white/80 underline hover:text-white">← Back to Products</a>
    </p>
  </main>
</Layout>
